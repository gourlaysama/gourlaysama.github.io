<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.0">Jekyll</generator><link href="https://gourlaysama.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://gourlaysama.github.io/" rel="alternate" type="text/html" /><updated>2021-04-29T18:29:12+02:00</updated><id>https://gourlaysama.github.io/feed.xml</id><title type="html">Gourlaysama’s blog</title><subtitle>My blog</subtitle><author><name>Antoine Gourlay</name></author><entry><title type="html">Going further with DNF in Fedora</title><link href="https://gourlaysama.github.io/tech/21/fedora-dnf-tips" rel="alternate" type="text/html" title="Going further with DNF in Fedora" /><published>2021-04-29T15:39:00+02:00</published><updated>2021-04-29T15:39:00+02:00</updated><id>https://gourlaysama.github.io/tech/21/fedora-dnf-tips</id><content type="html" xml:base="https://gourlaysama.github.io/tech/21/fedora-dnf-tips">&lt;p&gt;Fedora’s DNF package manager is easy to use for everyday tasks, but it’s also easy to miss
some very useful lesser known features.
&lt;!--more--&gt;
This article will look at how to accomplish more with the typical DNF commands you already use.&lt;/p&gt;

&lt;h2 id=&quot;running-without-the-network&quot;&gt;Running without the network&lt;/h2&gt;

&lt;p&gt;DNF regularly connects to the network to refresh metadata&lt;label for=&quot;1&quot; class=&quot;margin-toggle sidenote-number&quot;&gt;&lt;/label&gt;&lt;input type=&quot;checkbox&quot; id=&quot;1&quot; class=&quot;margin-toggle&quot; /&gt;&lt;span class=&quot;sidenote&quot;&gt;The default in Fedora
is seven days for base repositories and six hours for update repositories. This can be changed
with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;metadata_expire&lt;/code&gt; configuration option. &lt;/span&gt;. This slows down even commands that do not
need information from a repository to work.&lt;/p&gt;

&lt;p&gt;You can run with the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-C/--cacheonly&lt;/code&gt; option to skip the network:&lt;/p&gt;

&lt;div class=&quot;language-sh console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dnf &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; list installed &lt;span class=&quot;s1&quot;&gt;'gtk*'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre class=&quot;larger&quot;&gt;&lt;code class=&quot;language-none&quot;&gt;Installed Packages
gtk-update-icon-cache.x86_64      3.24.28-2.fc33        @updates
gtk-vnc2.x86_64                   1.0.0-3.fc33          @fedora
gtk2.x86_64                       2.24.33-1.fc33        @updates
gtk3.x86_64                       3.24.28-2.fc33        @updates
gtk3-devel.x86_64                 3.24.28-2.fc33        @updates
gtkmm30.x86_64                    3.24.4-1.fc33         @updates
gtksourceview3.x86_64             3.24.11-4.fc33        @fedora
gtksourceview4.x86_64             4.8.1-1.fc33          @updates
gtkspell3.x86_64                  3.0.10-6.fc33         @fedora
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This option always uses the system cache (the cache of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;root&lt;/code&gt; user), which is presumably
more up-to-date than the cache of the local user. You will however get an error if you try to
install a package with this, since the cache normally never contains packages waiting to be
installed.&lt;/p&gt;

&lt;h2 id=&quot;fedoras-archive-repository&quot;&gt;Fedora’s archive repository&lt;/h2&gt;

&lt;p&gt;The normal Fedora repositories only keep two versions of the same package: the latest (in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;updates&lt;/code&gt;
repository), and the first one for the current version of Fedora (in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fedora&lt;/code&gt; repository). This
can be seen by listing duplicates of a package:&lt;/p&gt;

&lt;p class=&quot;bnote&quot;&gt;&lt;label for=&quot;mm-systemd-ver&quot; class=&quot;margin-toggle&quot;&gt; &amp;#8853;&lt;/label&gt;&lt;input type=&quot;checkbox&quot; id=&quot;mm-systemd-ver&quot; class=&quot;margin-toggle&quot; /&gt;&lt;span class=&quot;marginnote&quot;&gt;Note the only two options under &lt;code&gt;Available Packages&lt;/code&gt;: &lt;code&gt;246.6-3&lt;/code&gt; at the time Fedora 33 was released, and
&lt;code&gt;246.13-1&lt;/code&gt;, the current version. &lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;language-sh console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dnf &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; list &lt;span class=&quot;nt&quot;&gt;--showduplicates&lt;/span&gt; systemd.x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-none&quot;&gt;Installed Packages
systemd.x86_64         246.13-1.fc33      @updates
Available Packages
systemd.x86_64         246.6-3.fc33       fedora
systemd.x86_64         246.13-1.fc33      updates
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;downgrading-a-package&quot;&gt;Downgrading a package&lt;/h3&gt;

&lt;p&gt;As a result, downgrading a package in Fedora, while theoretically easy, can cause surprises.
For example, trying to downgrade &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;systemd&lt;/code&gt; will go all the way down seven (minor) versions, to the
version from the Fedora 33 release:&lt;/p&gt;

&lt;div class=&quot;language-sh console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf downgrade systemd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre class=&quot;larger&quot;&gt;&lt;code class=&quot;language-none&quot;&gt;Dependencies resolved.
===============================================================================
 Package                  Architecture Version              Repository    Size
===============================================================================
Downgrading:
 systemd                  x86_64       246.6-3.fc33         fedora       4.0 M
 systemd-container        x86_64       246.6-3.fc33         fedora       498 k
 systemd-devel            x86_64       246.6-3.fc33         fedora       429 k
 systemd-libs             x86_64       246.6-3.fc33         fedora       578 k
 systemd-networkd         x86_64       246.6-3.fc33         fedora       467 k
 systemd-pam              x86_64       246.6-3.fc33         fedora       308 k
 systemd-rpm-macros       noarch       246.6-3.fc33         fedora        29 k
 systemd-udev             x86_64       246.6-3.fc33         fedora       1.5 M

Transaction Summary
===============================================================================
Downgrade  8 Packages
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That usually isn’t what you want when trying to downgrade a recently updated package.&lt;/p&gt;

&lt;h3 id=&quot;using-the-archive-repository&quot;&gt;Using the archive repository&lt;/h3&gt;

&lt;p&gt;Fortunately Fedora includes a repository that contains all packages that ever reached the
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;updates&lt;/code&gt; repository. After installing it:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;fedora-repos-archive
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It becomes available for use (but disabled by default), and contains everything you might
expect:&lt;/p&gt;

&lt;div class=&quot;language-sh console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dnf list &lt;span class=&quot;nt&quot;&gt;--showduplicates&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enablerepo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;updates-archive systemd.x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre class=&quot;larger&quot;&gt;&lt;code class=&quot;language-none&quot;&gt;Installed Packages
systemd.x86_64         246.13-1.fc33      @updates
Available Packages
systemd.x86_64         246.6-3.fc33       fedora
systemd.x86_64         246.7-1.fc33       updates-archive
systemd.x86_64         246.7-2.fc33       updates-archive
systemd.x86_64         246.10-1.fc33      updates-archive
systemd.x86_64         246.13-1.fc33      updates
systemd.x86_64         246.13-1.fc33      updates-archive
&lt;/code&gt;&lt;/pre&gt;

&lt;p class=&quot;bnote&quot;&gt;&lt;label for=&quot;mm-systemd-2&quot; class=&quot;margin-toggle&quot;&gt; &amp;#8853;&lt;/label&gt;&lt;input type=&quot;checkbox&quot; id=&quot;mm-systemd-2&quot; class=&quot;margin-toggle&quot; /&gt;&lt;span class=&quot;marginnote&quot;&gt;The more recent &lt;code&gt;246.10-1&lt;/code&gt; version is now available! &lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;language-sh console console-cont highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf downgrade &lt;span class=&quot;nt&quot;&gt;--enablerepo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;updates-archive systemd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre class=&quot;larger&quot;&gt;&lt;code class=&quot;language-none&quot;&gt;Dependencies resolved.
===============================================================================
 Package                Arch       Version           Repository           Size
===============================================================================
Downgrading:
 systemd                x86_64     246.10-1.fc33     updates-archive     4.1 M
 systemd-container      x86_64     246.10-1.fc33     updates-archive     494 k
 systemd-devel          x86_64     246.10-1.fc33     updates-archive     425 k
 systemd-libs           x86_64     246.10-1.fc33     updates-archive     579 k
 systemd-networkd       x86_64     246.10-1.fc33     updates-archive     464 k
 systemd-pam            x86_64     246.10-1.fc33     updates-archive     307 k
 systemd-rpm-macros     noarch     246.10-1.fc33     updates-archive      24 k
 systemd-udev           x86_64     246.10-1.fc33     updates-archive     1.5 M

Transaction Summary
===============================================================================
Downgrade  8 Packages
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;undoing-history&quot;&gt;Undoing history&lt;/h3&gt;

&lt;p&gt;This also allows to successfully undo transactions with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dnf history undo&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dnf history rollback&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-sh console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;history &lt;/span&gt;undo last 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre class=&quot;larger&quot;&gt;&lt;code class=&quot;language-none&quot;&gt;Error: The following problems occurred while running a transaction:
  Cannot find rpm nevra &quot;fedpkg-1.40-5.fc33.noarch&quot;.
  Cannot find rpm nevra &quot;vim-X11-2:8.2.2637-1.fc33.x86_64&quot;.
  Cannot find rpm nevra &quot;vim-common-2:8.2.2637-1.fc33.x86_64&quot;.
  Cannot find rpm nevra &quot;vim-enhanced-2:8.2.2637-1.fc33.x86_64&quot;.
  Cannot find rpm nevra &quot;vim-filesystem-2:8.2.2637-1.fc33.noarch&quot;.
  Cannot find rpm nevra &quot;vim-minimal-2:8.2.2637-1.fc33.x86_64&quot;.
&lt;/code&gt;&lt;/pre&gt;

&lt;div class=&quot;language-sh console console-cont highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;history &lt;/span&gt;undo last &lt;span class=&quot;nt&quot;&gt;--enablerepo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;updates-archive
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre class=&quot;larger&quot;&gt;&lt;code class=&quot;language-none&quot;&gt;Dependencies resolved.
===============================================================================
 Package            Arch       Version               Repository           Size
===============================================================================
Downgrading:
 fedpkg             noarch     1.40-5.fc33           updates-archive      88 k
 vim-X11            x86_64     2:8.2.2637-1.fc33     updates-archive     1.9 M
 vim-common         x86_64     2:8.2.2637-1.fc33     updates-archive     6.7 M
 vim-enhanced       x86_64     2:8.2.2637-1.fc33     updates-archive     1.8 M
 vim-filesystem     noarch     2:8.2.2637-1.fc33     updates-archive      23 k
 vim-minimal        x86_64     2:8.2.2637-1.fc33     updates-archive     685 k

Transaction Summary
===============================================================================
Downgrade  6 Packages
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note that the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;updates-archive&lt;/code&gt; repository should probably be kept disabled by default, because
querying it is significantly slower than other repositories&lt;label for=&quot;2&quot; class=&quot;margin-toggle sidenote-number&quot;&gt;&lt;/label&gt;&lt;input type=&quot;checkbox&quot; id=&quot;2&quot; class=&quot;margin-toggle&quot; /&gt;&lt;span class=&quot;sidenote&quot;&gt;Because it has a lot
more metadata than normal: it only ever keeps growing in size, while the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;updates&lt;/code&gt; repository is
cleaned of old packages to keep it fast. &lt;/span&gt;.&lt;/p&gt;

&lt;h3 id=&quot;locking-a-package-in-place&quot;&gt;Locking a package in place&lt;/h3&gt;

&lt;p&gt;Keeping a downgraded package around can be annoying if DNF tries to upgrade it back again all
the time.&lt;/p&gt;

&lt;p&gt;However, there is a &lt;a href=&quot;https://dnf-plugins-core.readthedocs.io/en/latest/versionlock.html&quot;&gt;DNF command for this&lt;/a&gt;,
though you might have to install it first:&lt;/p&gt;

&lt;p&gt;&lt;label for=&quot;mm-lock&quot; class=&quot;margin-toggle&quot;&gt; ⊕&lt;/label&gt;&lt;input type=&quot;checkbox&quot; id=&quot;mm-lock&quot; class=&quot;margin-toggle&quot; /&gt;&lt;span class=&quot;marginnote&quot;&gt;Yes, this can be used to locate and install DNF commands, see below. &lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'dnf-command(versionlock)'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then it can be used to lock packages in place:&lt;/p&gt;

&lt;div class=&quot;language-sh console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; versionlock add &lt;span class=&quot;s1&quot;&gt;'vim*'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-none&quot;&gt;Adding versionlock on: vim-minimal-2:8.2.2735-1.fc33.*
Adding versionlock on: vim-powerline-0:2.8.2-1.fc33.*
Adding versionlock on: vim-filesystem-2:8.2.2735-1.fc33.*
Adding versionlock on: vim-common-2:8.2.2735-1.fc33.*
Adding versionlock on: vim-X11-2:8.2.2735-1.fc33.*
Adding versionlock on: vim-enhanced-2:8.2.2735-1.fc33.*
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can for example use it to lock a package to minor updates:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; versionlock add &lt;span class=&quot;nt&quot;&gt;--raw&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'firefox-88.*'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Or on the contrary exclude minor updates and wait for the next major one:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; versionlock exclude &lt;span class=&quot;nt&quot;&gt;--raw&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'firefox-88.*'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This can be used to include or exclude packages in a more precise way, compared to adding
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exclude&lt;/code&gt; entries in the DNF configuration.&lt;/p&gt;

&lt;h2 id=&quot;paths-instead-of-package-names&quot;&gt;Paths instead of package names&lt;/h2&gt;

&lt;p&gt;Several DNF commands support using paths on the file-system instead of a package name.
The obvious example is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;provide&lt;/code&gt;, which displays packages that provide the file at that path:&lt;/p&gt;

&lt;div class=&quot;language-sh console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dnf provides /etc/vimrc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre class=&quot;larger&quot;&gt;&lt;code class=&quot;language-none&quot;&gt;Last metadata expiration check: 1:55:07 ago on Mon 26 Apr 2021 10:19:03 AM CEST.
vim-common-2:8.2.1770-1.fc33.x86_64 : The common files needed by any version of the VIM editor
Repo        : fedora
Matched from:
Filename    : /etc/vimrc

vim-common-2:8.2.2787-1.fc33.x86_64 : The common files needed by any version of the VIM editor
Repo        : updates
Matched from:
Filename    : /etc/vimrc
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As a special convenience, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dnf provide&lt;/code&gt; will prefix&lt;label for=&quot;3&quot; class=&quot;margin-toggle sidenote-number&quot;&gt;&lt;/label&gt;&lt;input type=&quot;checkbox&quot; id=&quot;3&quot; class=&quot;margin-toggle&quot; /&gt;&lt;span class=&quot;sidenote&quot;&gt;this only works with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;provide&lt;/code&gt;! &lt;/span&gt;
 the search term with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/bin/&lt;/code&gt; if there is no match (and then &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/sbin&lt;/code&gt;), so the
following will work:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dnf provides bzcat
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But the path doesn’t actually have to exist locally at all. For example, when installing a
package:&lt;/p&gt;

&lt;p&gt;&lt;label for=&quot;mm-dnf-path&quot; class=&quot;margin-toggle&quot;&gt; ⊕&lt;/label&gt;&lt;input type=&quot;checkbox&quot; id=&quot;mm-dnf-path&quot; class=&quot;margin-toggle&quot; /&gt;&lt;span class=&quot;marginnote&quot;&gt;Note that it needs to be an &lt;em&gt;absolute&lt;/em&gt; path here, otherwise you should use a wildcard. &lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; /usr/bin/gvim
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Wildcards can also be used:&lt;/p&gt;

&lt;div class=&quot;language-sh console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dnf provides &lt;span class=&quot;s1&quot;&gt;'*/libbz2.so*'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre class=&quot;larger&quot;&gt;&lt;code class=&quot;language-none&quot;&gt;Last metadata expiration check: 1 day, 18:45:49 ago on Sat 17 Apr 2021 07:43:37 PM CEST.
bzip2-devel-1.0.8-4.fc33.i686 : Libraries and header files for apps which will use bzip2
Repo        : fedora
Matched from:
Filename    : /usr/lib/libbz2.so

bzip2-devel-1.0.8-4.fc33.x86_64 : Libraries and header files for apps which will use bzip2
Repo        : fedora
Matched from:
Filename    : /usr/lib64/libbz2.so

bzip2-libs-1.0.8-4.fc33.i686 : Libraries for applications using bzip2
Repo        : fedora
Matched from:
Filename    : /usr/lib/libbz2.so.1
Filename    : /usr/lib/libbz2.so.1.0.8

bzip2-libs-1.0.8-4.fc33.x86_64 : Libraries for applications using bzip2
Repo        : fedora
Matched from:
Filename    : /usr/lib64/libbz2.so.1
Filename    : /usr/lib64/libbz2.so.1.0.8
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This can be particularly useful to re-install locally modified files:&lt;/p&gt;

&lt;p&gt;&lt;label for=&quot;mm-reinstall-config&quot; class=&quot;margin-toggle&quot;&gt; ⊕&lt;/label&gt;&lt;input type=&quot;checkbox&quot; id=&quot;mm-reinstall-config&quot; class=&quot;margin-toggle&quot; /&gt;&lt;span class=&quot;marginnote&quot;&gt;Note that this will not work for most configuration files in
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc&lt;/code&gt; since packages are usually instructed to leave local configuration changes alone. &lt;/span&gt;&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf reinstall &lt;span class=&quot;s1&quot;&gt;'/usr/share/themes/*'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf reinstall &lt;span class=&quot;s1&quot;&gt;'/boot/*'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;rich-dependencies&quot;&gt;Rich dependencies&lt;/h2&gt;

&lt;p&gt;Packages in Fedora can provide more that file paths. They also expose richer information
about what becomes available once the package is installed.&lt;/p&gt;

&lt;h3 id=&quot;missing-libraries&quot;&gt;Missing libraries&lt;/h3&gt;

&lt;p&gt;Packages expose native library dependencies directly, so an error message like this:&lt;/p&gt;

&lt;pre class=&quot;larger&quot;&gt;&lt;code class=&quot;language-none&quot;&gt;error while loading shared libraries: libbz2.so.1: \
  cannot open shared object file: No such file or directory
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Can be diagnosed with:&lt;/p&gt;

&lt;div class=&quot;language-sh console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dnf provides &lt;span class=&quot;s1&quot;&gt;'libbz2.so.*'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre class=&quot;larger&quot;&gt;&lt;code class=&quot;language-none&quot;&gt;Last metadata expiration check: 2:03:46 ago on Tue Apr 20 08:19:21 2021.
bzip2-libs-1.0.8-4.fc33.i686 : Libraries for applications using bzip2
Repo        : fedora
Matched from:
Provide    : libbz2.so.1

bzip2-libs-1.0.8-4.fc33.x86_64 : Libraries for applications using bzip2
Repo        : @System
Matched from:
Provide    : libbz2.so.1()(64bit)

bzip2-libs-1.0.8-4.fc33.x86_64 : Libraries for applications using bzip2
Repo        : fedora
Matched from:
Provide    : libbz2.so.1()(64bit)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;build-dependencies&quot;&gt;Build dependencies&lt;/h3&gt;

&lt;p&gt;When manually compiling programs, build systems often use  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pkgconfig&lt;/code&gt; to locate
dependencies. The same dependency names can be used with DNF, regardless of the
actual name of the package:&lt;/p&gt;

&lt;div class=&quot;language-sh console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# before compiling a program that requires dbus&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'pkgconfig(dbus-1)'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre class=&quot;larger&quot;&gt;&lt;code class=&quot;language-none&quot;&gt;Dependencies resolved.
===============================================================================
 Package                 Arch        Version                Repository    Size
===============================================================================
Installing:
 dbus-devel              x86_64      1:1.12.20-2.fc33       fedora        36 k
Installing dependencies:
 libpkgconf              x86_64      1.7.3-5.fc33           updates       36 k
 pkgconf                 x86_64      1.7.3-5.fc33           updates       41 k
 pkgconf-m4              noarch      1.7.3-5.fc33           updates       14 k
 pkgconf-pkg-config      x86_64      1.7.3-5.fc33           updates       10 k
 xml-common              noarch      0.6.3-55.fc33          fedora        31 k

Transaction Summary
===============================================================================
Install  6 Packages
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;fonts&quot;&gt;Fonts&lt;/h3&gt;

&lt;p&gt;Packaged fonts can be installed by name:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;font&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;firasans&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# or all the fira fonts:&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;font&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fira&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thus you can list all fonts packaged in Fedora with:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dnf provides &lt;span class=&quot;s1&quot;&gt;'font(*)'&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;Provide | &lt;span class=&quot;nb&quot;&gt;sort&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;dnf-commands&quot;&gt;DNF commands&lt;/h3&gt;

&lt;p&gt;You sometimes see DNF commands that are not available on a system by default—in blog
posts for example. Those can be installed by DNF with:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'dnf-command(torproxy)'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;libraries-from-various-ecosystems&quot;&gt;Libraries from various ecosystems&lt;/h3&gt;

&lt;p&gt;It is sometimes useful to have a library installed in the standard Python/Ruby/…
environment provided by Fedora. The naming of packages is usually consistent enough that
you can guess where to find something, but you can also use the following:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'rubygem(bundler)'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'perl(Socket)'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'python3dist(httplib2)'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dnf &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'ocaml(Rope)'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;mime-handlers&quot;&gt;MIME handlers&lt;/h3&gt;

&lt;p&gt;DNF can be used to find applications capable of opening a file, using its &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mime-type&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-sh console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# what is that unknown file?&lt;/span&gt;
file &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--mime-type&lt;/span&gt; pres.ppt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-none&quot;&gt;application/vnd.ms-powerpoint
&lt;/code&gt;&lt;/pre&gt;

&lt;div class=&quot;language-sh console console-cont highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# how can I open it?&lt;/span&gt;
dnf provides &lt;span class=&quot;s1&quot;&gt;'mimehandler(application/vnd.ms-powerpoint)'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre class=&quot;larger&quot;&gt;&lt;code class=&quot;language-none&quot;&gt;calligra-okular-odpgenerator-3.2.1-4.fc33.i686 : OpenDocument presenter support for okular
Repo        : fedora
Matched from:
Provide    : mimehandler(application/vnd.ms-powerpoint)

calligra-okular-odpgenerator-3.2.1-4.fc33.x86_64 : OpenDocument presenter support for okular
Repo        : fedora
Matched from:
Provide    : mimehandler(application/vnd.ms-powerpoint)

calligra-stage-3.2.1-4.fc33.x86_64 : A full-featured presentation program
Repo        : fedora
Matched from:
Provide    : mimehandler(application/vnd.ms-powerpoint)

libreoffice-impress-1:7.0.1.2-5.fc33.x86_64 : LibreOffice Presentation Application
Repo        : fedora
Matched from:
Provide    : mimehandler(application/vnd.ms-powerpoint)

libreoffice-impress-1:7.0.5.2-1.fc33.x86_64 : LibreOffice Presentation Application
Repo        : updates
Matched from:
Provide    : mimehandler(application/vnd.ms-powerpoint)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;wrapping-up&quot;&gt;Wrapping up&lt;/h2&gt;

&lt;p&gt;These are just some of DNF’s less used features that can help managing your system.
Hopefully this has been useful to make your life on the command line easier.&lt;/p&gt;

&lt;p&gt;For a more complete tour of DNF see the &lt;a href=&quot;https://dnf.readthedocs.io/en/latest/&quot;&gt;DNF documentation&lt;/a&gt; and the &lt;a href=&quot;https://dnf-plugins-core.readthedocs.io/en/latest/index.html&quot;&gt;Core DNF Plugins Documentation&lt;/a&gt;.&lt;/p&gt;</content><author><name>Antoine Gourlay</name></author><category term="tech" /><category term="Fedora" /><summary type="html">Fedora’s DNF package manager is easy to use for everyday tasks, but it’s also easy to miss some very useful lesser known features.</summary></entry><entry><title type="html">Hello, world</title><link href="https://gourlaysama.github.io/other/21/hello-world" rel="alternate" type="text/html" title="Hello, world" /><published>2021-04-22T14:52:00+02:00</published><updated>2021-04-22T14:52:00+02:00</updated><id>https://gourlaysama.github.io/other/21/hello-world</id><content type="html" xml:base="https://gourlaysama.github.io/other/21/hello-world">&lt;p&gt;I’m beginning an attempt at blogging again.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;It’s been many years since I last blogged, but I’ve decided to start again. We’ll see where it
goes.&lt;/p&gt;

&lt;p&gt;The posts will be mostly technical—some Rust, some Scala, stuff about Fedora and Linux,
who knows what else—but I may blog about other things here and there. If needed I’ll add a
dedicated feed for technical posts.&lt;/p&gt;</content><author><name>Antoine Gourlay</name></author><category term="other" /><category term="about" /><summary type="html">I’m beginning an attempt at blogging again.</summary></entry></feed>